{% load static tailwind_tags %}
{% tailwind_css %}
<div class="flex items-center justify-center w-full h-full rounded-2xl">
	<div class="flex flex-col items-center justify-center border shadow-2xl rounded-2xl border-solid border-gray-300 h-[500px] w-[500px] gap-6">
		<h1 class="pt-5 text-4xl font-bold">Join Class</h1>
		<div class="flex flex-col items-center justify-center w-full h-full gap-6">
			<label for="id_subject_id" class="text-2xl font-bold ">Class Code</label>
			<input id="id_subject_id" type="text" placeholder="Input Class Code..." class="w-[50%] border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring focus:border-blue-300">
			<button type="submit" id="join-class" onclick="joinClass()" class="w-[25%] h-[50px] border border-solid border-gray-300 cursor-pointer bg-black rounded-xl hover:bg-gray-200 hover:text-black text-white">Join</button>
		</div>
	</div>
</div>

<script>
	async function joinClass() {
		let subject_id = document.getElementById("id_subject_id");
		const response = await fetch("/e/", {
			method : "POST",
			headers : {
				"Content-Type" : "application/json",
				"X-CSRFToken" : getCookie("csrftoken")
			},
			body : JSON.stringify({
				"subject_id" : subject_id.value
			})
		});

		if(response.ok) {
			const data = await response.json()
			subject_id.value = "";

			if (data.redirect_url) {
		        window.location.href = data.redirect_url;
		    }
		}
	}

	function getCookie(name) {
	    let cookieValue = null;
	    if (document.cookie && document.cookie !== '') {
	        const cookies = document.cookie.split(';');
	        for (let i = 0; i < cookies.length; i++) {
	            const cookie = cookies[i].trim();
	            // Does this cookie string begin with the name we want?
	            if (cookie.substring(0, name.length + 1) === (name + '=')) {
	                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
	                break;
	            }
	        }
	    }
	    return cookieValue;
	}
</script>